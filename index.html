<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ben 10 Clásico</title>
  <link rel="stylesheet" href="estilos.css" />
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <meta name="description" content="Mirá online todos los capítulos de Ben 10 Clásico en orden y sin perder tu progreso.">
  <meta name="keywords" content="Ben 10, Ben 10 clásico, ver online, capítulos, dibujos animados">
  <meta name="author" content="Ulises" />

  <style>
    /* Estilo adicional SOLO para iframe */
    iframe.video {
      width: 100%;
      max-width: 960px;
      aspect-ratio: 16 / 9;
      height: auto;
      border-radius: 10px;
      box-shadow: 0 0 20px #0f0;
      display: block;
      margin: 20px auto;
    }
  </style>
</head>
<body>

  <!-- Logo -->
  <img src="logo-ben10.png" alt="Ben 10 Clásico" class="logo" />

  <!-- Selector de Capítulo -->
  <label for="selector">Selecciona un capítulo:</label>
  <select id="selector" onchange="seleccionarCapitulo(this.value)"></select>

  <!-- Reproductor -->
  <div id="contenedor-video">
    <iframe id="video" class="video" allowfullscreen allow="autoplay; encrypted-media; picture-in-picture" frameborder="0"></iframe>
  </div>

  <!-- Botones -->
  <div class="botones">
    <button onclick="anteriorCapitulo()">Anterior</button>
    <button onclick="siguienteCapitulo()">Siguiente</button>
  </div>

  <!-- Script de funcionalidad -->
  <script src="https://player.vimeo.com/api/player.js"></script> <!-- AGREGADO: para poder leer el tiempo del video -->
  <script>
    const total = 13;
    let capActual = 1;

    const selector = document.getElementById("selector");
    const video = document.getElementById("video");

    const videosVimeo = [
      "1078816581", // 1
      "1078818189", // 2
      "1078818699", // 3
      "1078819081", // 4
      "1078848454", // 5
      "1078848947", // 6
      "1078849262", // 7
      "1078849503", // 8
      "1078853780", // 9
      "1078853990", // 10
      "1078854221", // 11
      "1078854983", // 12
      "1078855267"  // 13
    ];

    const nombresCapitulos = [
      "Y fueron 10",
      "Aprendiendo a ser héroe",
      "El Krakken",
      "Visitando a los viejos",
      "Buscando el Omnitrix",
      "Trampa para turistas",
      "Copiando poderes",
      "La Alianza",
      "La Última risa",
      "La chica de la suerte",
      "Un pequeño problema",
      "Efectos secundarios",
      "Secretos"
    ];

    for (let i = 1; i <= total; i++) {
      const option = document.createElement("option");
      option.value = i;
      option.textContent = nombresCapitulos[i - 1];
      selector.appendChild(option);
    }

    function seleccionarCapitulo(numero) {
      capActual = parseInt(numero);
      localStorage.setItem("tiempoBen10", 0);
      cargarCapitulo();
    }

    function anteriorCapitulo() {
      if (capActual > 1) {
        capActual--;
        cargarCapitulo();
      }
    }

    function siguienteCapitulo() {
      if (capActual < total) {
        capActual++;
        cargarCapitulo();
      }
    }

    function guardarProgreso() {
      localStorage.setItem("capituloBen10", capActual);
    }

    function cargarCapitulo(inicioEn = 0) {
  const vimeoID = videosVimeo[capActual - 1];
  let url = `https://player.vimeo.com/video/${vimeoID}?autoplay=1`; // <-- SIEMPRE autoplay=1

  if (inicioEn > 0) {
    url += `#t=${Math.floor(inicioEn)}s`;
  }

  video.src = url;
  selector.value = capActual;
  guardarProgreso();
}

    // Guardar segundo actual del video cada 10 segundos
    setInterval(() => {
      const player = new Vimeo.Player(video);
      player.getCurrentTime().then(function(segundos) {
        localStorage.setItem("tiempoBen10", segundos);
      }).catch(function(error) {
        console.error('Error al obtener el tiempo:', error);
      });
    }, 10000);

    // Al volver, preguntar si reanudar
    function cargarProgreso() {
      const capGuardado = localStorage.getItem("capituloBen10");
      const tiempoGuardado = localStorage.getItem("tiempoBen10");

      if (capGuardado && tiempoGuardado) {
        capActual = parseInt(capGuardado);
        const tiempoEnSegundos = parseFloat(tiempoGuardado);

        const minutos = Math.floor(tiempoEnSegundos / 60);
        const segundos = Math.floor(tiempoEnSegundos % 60);
        const tiempoFormateado = `${minutos}:${segundos.toString().padStart(2, "0")}`;

        const volver = confirm(`Eu, te quedaste en el capítulo ${capActual} en el minuto ${tiempoFormateado}. ¿Querés reanudar?`);
        if (volver) {
          cargarCapitulo(tiempoEnSegundos);
        } else {
          localStorage.setItem("tiempoBen10", 0);
          cargarCapitulo();
        }
      } else {
        cargarCapitulo();
      }
    }

    cargarProgreso();
  </script>

  <footer style="text-align: center; margin-top: 40px; color: #888;">
    <p>&copy;2025 Ulises - FanProject of Ben 10</p>
  </footer>

</body>
</html>
